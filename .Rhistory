knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
library(readxl)
library(tidyverse)
library(ggraph)
library(igraph)
library(ggrepel)
setwd("~/Documents/GitHub/tracing")
dat <- read_csv("KAtrace.csv",  skip = 19)
dat$Date <- as.Date(dat$Date, "%d-%b")
dat <- dat %>% group_by(Cluster) %>% mutate(n_cluster = n())
dat$origin_cluster <- ifelse(dat$n_cluster < 200, "Others", as.character(dat$Cluster))
names(edges) <- c("Source", "Target")
View(dat)
dat %>% group_by(P) %>% summarize(`Secondary infections` = n())
secondary <- dat %>% group_by(P) %>% summarize(`Secondary infections` = n())
write_csv(secondary, "secondary_infections.csv")
ggplot(secondary, aes(secondary$`Secondary infections`)) + geom_histogram()
secondary %>% filter(P >0) %>% ggplot(aes(secondary$`Secondary infections`)) + geom_histogram()
secondary %>% filter(P > 0) %>% ggplot(aes(secondary$`Secondary infections`)) + geom_histogram()
secondary %>% filter(P > 0) %>% ggplot(aes(`Secondary infections`)) + geom_histogram()
secondary %>% filter(`Secondary infections` > 30) %>% ggplot(aes(`Secondary infections`)) + geom_histogram()
secondary %>% filter(`Secondary infections` < 30) %>% ggplot(aes(`Secondary infections`)) + geom_histogram()
View(secondary)
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram()
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + theme_classic()
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
ggsave("secondary_hist.png")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(xintercept = 3.075967) + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
ggsave("secondary_hist.png")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(xintercept = 3.075967, color = "red") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
ggsave("secondary_hist.png")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(xintercept = 3.075967, color = "Red") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
ggsave("secondary_hist.png")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(xintercept = 3.075967, color = "Red", linetype="dashed") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
ggsave("secondary_hist.png")
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(color = "ew"), xintercept = 3.075967, color = "Red", linetype="dashed") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "ew"), , color = "Red", linetype="dashed") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "ew"), linetype="dashed") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "Average number of secondary infections"), linetype="dashed") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
ggsave("secondary_hist.png")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "Avg  secondary infections"), linetype="dashed") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
ggsave("secondary_hist.png")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "Avgsecondary infections"), linetype="dashed") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
ggsave("secondary_hist.png")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "Avg secondary infections"), linetype="dashed") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
ggsave("secondary_hist.png")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "Mean"), linetype="dashed") + theme_classic() + xlab("Secondary infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of secondary infections caused")
ggsave("secondary_hist.png")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`), med = median(`Secondary infections`))
View(secondary)
dat %>% ggplot(aes(Date)) + geom_bar(aes(fill=origin_cluster), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
ggsave("clusters.png")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`), med = median(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "Mean"), linetype="dashed") + theme_classic() + xlab("Number of infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of  infections caused")
ggsave("secondary_hist.png")
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
library(readxl)
library(tidyverse)
library(ggraph)
library(igraph)
library(ggrepel)
setwd("~/Documents/GitHub/tracing")
dat <- read_csv("KAtrace.csv",  skip = 19)
dat$Date <- as.Date(dat$Date, "%d-%b")
dat <- dat %>% group_by(Cluster) %>% mutate(n_cluster = n())
dat$origin_cluster <- ifelse(dat$n_cluster < 200, "Others", as.character(dat$Cluster))
dat %>% ggplot(aes(Date)) + geom_bar(aes(fill=origin_cluster), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
ggsave("clusters.png")
secondary <- dat %>% group_by(P) %>% summarize(`Secondary infections` = n())
write_csv(secondary, "secondary_infections.csv")
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`), med = median(`Secondary infections`))
secondary %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "Mean"), linetype="dashed") + theme_classic() + xlab("Number of infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of  infections caused")
ggsave("secondary_hist.png")
View(secondary)
View(dat)
dat %>% group_by(Cluster) %>% summarize(n_cluster = n())
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(aes(fill=origin_cluster), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
ggsave("clusters.png")
june30_parent <- secondary %>% filter(P <= 15242)
View(june30_parent)
secondary %>% summarise(mean = mean(`Secondary infections`))
secondary <- dat %>% group_by(P) %>% summarize(`Secondary infections` = n())
write_csv(secondary, "secondary_infections.csv")
june30_parent <- secondary %>% filter(P <= 15242 & P != 0)
secondary %>% summarise(mean = mean(`Secondary infections`))
secondary <- dat %>% group_by(P) %>% summarize(`Secondary infections` = n())
write_csv(secondary, "secondary_infections.csv")
june30_parent <- secondary %>% filter(P <= 15242 & P != 0)
june30_parent %>% summarise(mean = mean(`Secondary infections`))
june30_parent <- secondary %>% filter(P <= 11005 & P != 0)
june30_parent %>% summarise(mean = mean(`Secondary infections`))
secondary <- dat %>% group_by(P) %>% summarize(`Secondary infections` = n())
write_csv(secondary, "secondary_infections.csv")
june26_parent <- secondary %>% filter(P <= 11005 & P != 0)
june26_parent %>% summarise(mean = mean(`Secondary infections`))
View(june26_parent)
june26_parent %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "Mean"), linetype="dashed") + theme_classic() + xlab("Number of infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of  infections caused")
june26_parent %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "Mean"), linetype="dashed") + theme_classic() + xlab("Number of infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of  infections caused")
ggsave("secondary_hist.png")
View(secondary)
secondary %>% filter(`Secondary infections` < 100) %>% summarize(avg = mean(`Secondary infections`), med = median(`Secondary infections`))
june26_parent %>% filter(`Secondary infections` < 100) %>% ggplot(aes(`Secondary infections`)) + geom_histogram() + geom_vline(aes(xintercept = 3.075967, color = "Mean"), linetype="dashed") + theme_classic() + xlab("Number of infections caused by each patient") + ylab("Number of COVID-19 patients") + ggtitle("Distribution of number of  infections caused")
ggsave("secondary_hist.png")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_cluster), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat$origin_cluster <- ifelse(dat$n_cluster < 100, "Others", as.character(dat$Cluster))
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_cluster), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat$origin_cluster <- ifelse(dat$n_cluster < 50, "Others", as.character(dat$Cluster))
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_cluster), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_cluster), alpha = 0.7) + theme_classic() + theme(legend.position="bottom")  + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
100
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_cluster), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_cluster), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="BBrG") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_cluster), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat <- dat %>% group_by(Cluster) %>% mutate(n_cluster = n())
dat %>% group_by(Cluster) %>% summarize(n_cluster = n())
dat$origin_1 <- ifelse(dat$n_cluster < 100, "Others", as.character(dat$Cluster))
dat$origin_2 <- ifelse(dat$n_cluster < 200, "Others", as.character(dat$Cluster))
?ggbrewer
?scale_fill_brewer
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlGnBu") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="PuBuGn") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlOrRd") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, width = 0.8) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlOrRd") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, line = 0.8) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlOrRd") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "0.8"black) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlOrRd") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black") + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlOrRd") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", width = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlOrRd") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlOrRd") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlGnBu") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlGnBu", direction = -1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat$origin_1 <- ifelse(dat$n_cluster < 50, "Others", as.character(dat$Cluster))
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlGnBu", direction = -1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat$origin_1 <- ifelse(dat$n_cluster < 100, "Others", as.character(dat$Cluster))
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
ggsave("clusters_stacked.png")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlGnBu", direction = -1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlGnBu", direction = -1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Proportion of cases")
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
library(readxl)
library(tidyverse)
library(ggraph)
library(igraph)
library(ggrepel)
setwd("~/Documents/GitHub/tracing")
dat <- read_csv("KAtrace.csv",  skip = 19)
dat$Date <- as.Date(dat$Date, "%d-%b")
dat <- dat %>% group_by(Cluster) %>% mutate(n_cluster = n())
dat %>% group_by(Cluster) %>% summarize(n_cluster = n())
dat$origin_1 <- ifelse(dat$n_cluster < 100, "Others", as.character(dat$Cluster))
dat$origin_2 <- ifelse(dat$n_cluster < 200, "Others", as.character(dat$Cluster))
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlGnBu", direction = -1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Proportion of cases")
ggsave("clusters_stacked.png")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
ggsave("clusters_pct.png")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_y_log10()+scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") +scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_y_log10(labels = scales::comma)+scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + +scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + +scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases"ggsave("clusters_pct.png")
)
ggsave("clusters_pct.png")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + +scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlGnBu", direction = -1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Proportion of cases")
ggsave("clusters_stacked.png")
dat %>% filter(Date < "2020-05-31") %>% Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Date < "2020-05-31" & Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Date < "2020-05-31") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Date < "2020-06-30") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
5
dat %>% filter(Date < "2020-05-31") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Date < "2020-05-31") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_1), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="YlGnBu", direction = -1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Proportion of cases confirmed daily")
ggsave("clusters_stacked.png")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases confirmed daily")
ggsave("clusters_pct.png")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2", direction = -1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Proportion of cases confirmed daily")
ggsave("clusters_stacked.png")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2", direction = -1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Proportion of cases confirmed daily")
ggsave("clusters_stacked.png")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2", direction = 1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Proportion of cases confirmed daily")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar(position = "fill", aes(fill=origin_1), alpha = 0.7, color = "black", size = 0.1) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2", direction = 1) + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Proportion of cases confirmed daily")
ggsave("clusters_stacked.png")
dat %>% filter(Cluster != "29-June Trace History Absent" & Cluster != "28-June Trace History Absent" & Cluster != "27-June Trace History Absent") %>% ggplot(aes(Date)) + geom_bar( aes(fill=origin_2), alpha = 0.7) + theme_classic() + theme(legend.position="bottom") + scale_fill_brewer(palette="Dark2") + ggtitle("Distribution of cases diagnosed from various clusters over time") + ylab("Number of cases confirmed daily")
ggsave("clusters_pct.png")
